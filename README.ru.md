# SocksFusion

**SocksFusion** - это утилита для создания зашифрованного соединения ("туннеля"), который позволяет передавать TCP-сообщения через сетевой экран. **SocksFusion** состоит из двух компонентов: **Agent** - распространяемое приложение, и **Proxy** - сервис, устанавливаемый на стороне проекта BlackBox Scanner.

Приблизительная схема сетевых соединений:

                                           +-----------+
                                           | BBS Cloud |
                                           +-----------+
                                                 ^
                                     NAT         |
    +--------+         +-------+     | |     +-------+         +--------+
    | Target | <------ | Agent | ----|-|---> | Proxy | <------ | Client |
    +--------+         +-------+     | |     +-------+         +--------+


## Agent

**Agent** - это клиентское приложение, передающее запросы сканера от своего имени. После запуска устанавливает соединение с **Proxy**, осуществляет "рукопожатие" (handshake) и передаёт свой **Token**. В случае успешной авторизации можно начинать сканирование через данного агента. Агент слушает прокси и реагирует на запросы в соответствии с протоколом Socks5.

### Запуск агента

Использование: Agent [-o|--once] [-v|--version] [-s|--show-info]

Доступные опции:
  -p,--proxy host:port     Использовать выбранный прокси сервер
  -a,--api url             Использовать выбранный адрес API сервера
  --token string           Использовать выбранный токен
  --token-path path        Использовать выбранный путь для чтения/записи токена
  -i,--insecure            Не прекращать работу в случае ошибок проверки SSL сертификата
  -o,--once                Выйти по окончании сканирования или в случае возникновения ошибки
  -d,--debug               Показывать отладочую информацию о проходящих пакетах
  -s,--show-info           Показать версию агента и дату сборки
  -h,--help                Показать данную справочную информацию

## Proxy

**Proxy** - это сервер, соединяющий агентов и клиентов (экземпляров сканера). Для клиентских приложений **Proxy** предоставляет интерфейс Socks5.

## Token

**Token** - это случайная строка, служащая для авторизации конкретного агента. В случае, если агент не смог прочитать токен из командной строки или из файла, необходимо получить новый от API сервера при помощи кода активации. По умолчанию токен располагается по пути %APP_DATA%/bbs/RemoteAgent.token для Windows систем и $HOME/.bbs/RemoteAgent.token для Linux систем.
